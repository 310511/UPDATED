import React, { createContext, useContext, useState, useEffect, ReactNode } from "react";
import { translateText, translateBatch } from "@/services/translationService";

interface TranslationContextType {
  language: string;
  setLanguage: (lang: string) => void;
  translate: (text: string) => Promise<string>;
  translateKey: (key: string) => string;
  isTranslating: boolean;
  // Pre-translated common UI strings
  t: {
    hotels: string;
    destinations: string;
    deals: string;
    search: string;
    guestNationality: string;
    checkIn: string;
    checkOut: string;
    adults: string;
    children: string;
    rooms: string;
    selectCurrency: string;
    selectLanguage: string;
    [key: string]: string;
  };
}

const TranslationContext = createContext<TranslationContextType | undefined>(undefined);

// Common UI strings that need translation
const COMMON_STRINGS = {
  en: {
    hotels: "Hotels",
    destinations: "Destinations",
    deals: "Deals",
    search: "Search",
    guestNationality: "Guest Nationality",
    checkIn: "Check In",
    checkOut: "Check Out",
    adults: "Adults",
    children: "Children",
    rooms: "Rooms",
    selectCurrency: "Select Currency",
    selectLanguage: "Select Language",
    amenities: "Amenities",
    dining: "Dining",
    businessAmenities: "Business Amenities",
    nearbyAttractions: "Nearby Attractions",
    location: "Location",
    feesCharges: "Fees & Charges",
    policies: "Policies",
    bookNow: "Book Now",
    viewDetails: "View Details",
    price: "Price",
    perNight: "per night",
    rating: "Rating",
    reviews: "Reviews",
    freeCancellation: "Free Cancellation",
    breakfastIncluded: "Breakfast Included",
    wifi: "Free WiFi",
    parking: "Parking",
    pool: "Pool",
    gym: "Gym",
    spa: "Spa",
    findYourPerfect: "Find Your Perfect",
    dreamDestination: "Dream Destination",
    discoverAmazingHotels: "Discover amazing hotels, resorts, and stays at the best prices",
    whereAreYouGoing: "Where are you going?",
    guests: "Guests",
    enterDetails: "Enter details",
    searchDestinations: "Search destinations",
    popularDestinations: "Popular Destinations",
    searchCity: "Search City",
    searchCities: "Search cities...",
    whereTo: "Where to?",
    popularDestinationsLabel: "Popular destinations",
    selectGuestsRooms: "Select Guests & Rooms",
    guestsRooms: "Guests & Rooms",
    exploreHotels: "Explore Hotels",
    room: "Room",
    rooms: "Rooms",
    search: "Search",
    qSearch: "Search",
    // Discovery Feed
    getInspired: "Get Inspired",
    discoverYourNextAdventure: "Discover Your Next Adventure",
    exploreCuratedExperiences: "Explore curated experiences, read traveler stories, and find your perfect destination",
    all: "All",
    experiences: "Experiences",
    reviews: "Reviews",
    adventure: "Adventure",
    culture: "Culture",
    cityBreak: "City Break",
    featured: "Featured",
    // Destinations Page
    exploreAmazingDestinations: "Explore Amazing Destinations",
    discoverYourNext: "Discover Your Next",
    adventure: "Adventure",
    fromBustlingCities: "From bustling cities to serene beaches, explore",
    incredibleDestinations: "incredible destinations across the Middle East",
    cities: "Cities",
    hotels: "Hotels",
    avgRating: "Avg Rating",
    handPickedDestinations: "Hand-picked destinations offering the best accommodations and experiences",
    whyBookWithUs: "Why Book With Us",
    discoverBenefits: "Discover the benefits of choosing HotelRBS for your travels",
    bestPrices: "Best Prices",
    comparePrices: "Compare prices across 2,500+ hotels and get the best deals guaranteed",
    verifiedReviews: "Verified Reviews",
    readAuthenticReviews: "Read authentic reviews from real travelers who stayed there",
    localExpertise: "Local Expertise",
    getInsiderTips: "Get insider tips and recommendations for each destination",
    cantFindDestination: "Can't Find Your Destination?",
    requestNewDestination: "Request New Destination",
    topAttractions: "Top Attractions",
    trustedBy: "Trusted by 1M+ travelers worldwide",
    // Home Page
    browseByCategory: "Browse by Category",
    findPerfectAccommodation: "Find the perfect accommodation for your needs",
    luxuryHotels: "Luxury Hotels",
    businessHotels: "Business Hotels",
    familySuites: "Family Suites",
    weekendGetaways: "Weekend Getaways",
    starAccommodations: "5-star accommodations",
    perfectForBusinessTrips: "Perfect for business trips",
    spaciousFamilyRooms: "Spacious family rooms",
    perfectForShortTrips: "Perfect for short trips",
    featuredHotels: "Featured Hotels",
    handPickedAccommodations: "Hand-picked accommodations for your perfect stay",
    viewAll: "View All",
    experienceFinestHospitality: "Experience the finest hospitality",
    viewAllLuxury: "View All Luxury",
    perfectForBusinessTravelers: "Perfect for business travelers",
    viewAllBusiness: "View All Business",
    perfectEscapes: "Perfect escapes for short trips",
    viewAllGetaways: "View All Getaways",
    familyFriendlyHotels: "Family-Friendly Hotels",
    greatAccommodations: "Great accommodations for the whole family",
    viewAllFamily: "View All Family",
    // Deals Page
    specialDeals: "Special Deals",
    exclusiveOffers: "Exclusive Offers",
    findBestDeals: "Find the best deals and save on your next stay",
    flashDeals: "Flash Deals",
    limitedTime: "Limited Time",
    validUntil: "Valid Until",
    originalPrice: "Original Price",
    salePrice: "Sale Price",
    off: "off",
    bookNow: "Book Now",
    timeLeft: "Time Left",
    // Search Results
    searchResults: "Search Results",
    hotelsFound: "Hotels Found",
    sortBy: "Sort By",
    priceLowToHigh: "Price: Low to High",
    priceHighToLow: "Price: High to Low",
    rating: "Rating",
    distance: "Distance",
    filters: "Filters",
    clearAll: "Clear All",
    applyFilters: "Apply Filters",
    noHotelsFound: "No Hotels Found",
    tryDifferentSearch: "Try different search criteria",
    loading: "Loading...",
    perNight: "per night",
    // Hotel Details
    selectRoom: "Select Room",
    roomDetails: "Room Details",
    totalPrice: "Total Price",
    reserveNow: "Reserve Now",
    description: "Description",
    facilities: "Facilities",
    nearbyAttractions: "Nearby Attractions",
    reviews: "Reviews",
    writeReview: "Write a Review",
    // Common
    save: "Save",
    share: "Share",
    print: "Print",
    close: "Close",
    cancel: "Cancel",
    confirm: "Confirm",
    continue: "Continue",
    back: "Back",
    next: "Next",
    previous: "Previous",
    submit: "Submit",
    edit: "Edit",
    delete: "Delete",
    update: "Update",
    add: "Add",
    remove: "Remove",
    yes: "Yes",
    no: "No",
    // Footer
    secureBooking: "Secure Booking",
    sslEncrypted: "SSL Encrypted",
    bestPriceGuarantee: "Best Price Guarantee",
    lowestPrices: "Lowest Prices",
    support247: "24/7 Support",
    alwaysHere: "Always Here",
    flexiblePayment: "Flexible Payment",
    multipleOptions: "Multiple Options",
    footerDescription: "Your trusted partner for finding perfect accommodations worldwide. We connect travelers with exceptional stays, offering the best prices and seamless booking experience.",
    verified: "Verified",
    isoCertified: "ISO Certified",
    booking: "Booking",
    browseDestinations: "Browse Destinations",
    specialOffers: "Special Offers",
    searchHotels: "Search Hotels",
    groupBookings: "Group Bookings",
    corporateTravel: "Corporate Travel",
    giftCards: "Gift Cards",
    support: "Support",
    helpCenter: "Help Center",
    customerService: "Customer Service",
    bookingChanges: "Booking Changes",
    cancellationPolicy: "Cancellation Policy",
    travelInsurance: "Travel Insurance",
    faq: "FAQ",
    company: "Company",
    aboutUs: "About Us",
    careers: "Careers",
    pressMedia: "Press & Media",
    partnerWithUs: "Partner with Us",
    investorRelations: "Investor Relations",
    blog: "Blog",
    allRightsReserved: "All rights reserved.",
    privacyPolicy: "Privacy Policy",
    termsOfService: "Terms of Service",
    sitemap: "Sitemap",
    weAccept: "We accept:",
    // Reserve Page
    guestDetails: "Guest Details",
    roomNumber: "Room Number",
    title: "Title",
    firstName: "First Name",
    lastName: "Last Name",
    type: "Type",
    adult: "Adult",
    child: "Child",
    age: "Age",
    addGuest: "Add Guest",
    removeGuest: "Remove Guest",
    continueToBooking: "Continue to Booking",
    backToHotel: "Back to Hotel",
    reserveYourRoom: "Reserve Your Room",
    reserveRoom: "Reserve Room",
    reserveRoomDescription: "Click the button below to reserve your room. This will hold your reservation for a limited time.",
    bookingSummary: "Booking Summary",
    processing: "Processing...",
    primaryGuest: "Primary Guest",
    pleaseProvideGuestDetails: "Please provide details for all guests in each room",
    // Profile Page
    myBookings: "My Bookings",
    searchBookings: "Search Bookings",
    fromDate: "From Date",
    toDate: "To Date",
    search: "Search",
    bookingReference: "Booking Reference",
    lookupBooking: "Lookup Booking",
    noBookingsFound: "No bookings found",
    bookingDetails: "Booking Details",
    hotelName: "Hotel Name",
    checkInDate: "Check In Date",
    checkOutDate: "Check Out Date",
    bookingStatus: "Booking Status",
    filterByDateRange: "Filter by Date Range",
    refresh: "Refresh",
    confirmedBooking: "Confirmed Booking",
    // Booking Page
    bookingConfirmation: "Booking Confirmation",
    paymentDetails: "Payment Details",
    totalAmount: "Total Amount",
    // Wishlist
    myWishlist: "My Wishlist",
    savedHotels: "Saved Hotels",
    noSavedHotels: "No saved hotels yet",
    // Account
    myAccount: "My Account",
    personalInformation: "Personal Information",
    accountSettings: "Account Settings",
    // Payment
    paymentSuccessful: "Payment Successful!",
    paymentFailed: "Payment Failed",
    paymentDeclined: "Payment Declined",
    paymentCancelled: "Payment Cancelled",
    thankYouPayment: "Thank you for your payment. Your booking is now confirmed!",
    bookingConfirmed: "Booking Confirmed!",
    paymentPending: "Payment is yet to be done and booking is placed. Your booking has been confirmed successfully!",
    paymentNotSuccessful: "Unfortunately, your payment was not successful.",
    bookingNotConfirmed: "Your booking has not been confirmed. No charges have been made to your account.",
    paymentCancelledMessage: "You have cancelled the payment process.",
    checkingPaymentStatus: "Checking Payment Status...",
    retryPayment: "Retry Payment",
    returnToHome: "Return to Home",
    // NotFound
    pageNotFound: "404",
    oopsPageNotFound: "Oops! Page not found",
    // Reviews Section
    whatTravelersSay: "What Travelers Say",
    readReviews: "Read reviews from verified travelers",
    // Discovery Feed
    getInspired: "Get Inspired",
    discoverYourNextAdventure: "Discover Your Next Adventure",
    exploreCuratedExperiences: "Explore curated experiences, read traveler stories, and find your perfect destination",
    all: "All",
    experiences: "Experiences",
    adventure: "Adventure",
    culture: "Culture",
    cityBreak: "City Break",
    featured: "Featured",
    // Destination Story Section
    exploreDestination: "Explore Destination",
    findHotels: "Find Hotels",
    bestTimeToVisit: "Best Time to Visit",
    mustSeeHighlights: "Must-See Highlights",
    // Hotel Details Highlights
    keyAmenities: "Key Amenities",
    keyAmenitiesDescription: "Essential features that make your stay comfortable and memorable",
    highlightedFacilities: "Highlighted Facilities",
    highlightedFacilitiesDescription: "Premium features and services that set this property apart",
    uniqueOfferings: "Unique Offerings",
    uniqueOfferingsDescription: "Special features and experiences that make this hotel/resort stand out",
    spaDescription: "Relax and rejuvenate with our world-class spa services",
    poolDescription: "Enjoy our stunning pool area with premium amenities",
    gymDescription: "Stay fit with our fully equipped fitness center",
    restaurantDescription: "Savor exquisite cuisine at our on-site restaurants",
    wifiDescription: "Stay connected with high-speed internet throughout the property",
    premiumFeatureDescription: "Premium feature available for your comfort",
  },
  ar: {
    hotels: "الفنادق",
    destinations: "الوجهات",
    deals: "العروض",
    search: "بحث",
    guestNationality: "جنسية الضيف",
    checkIn: "تاريخ الوصول",
    checkOut: "تاريخ المغادرة",
    adults: "بالغين",
    children: "أطفال",
    rooms: "غرف",
    selectCurrency: "اختر العملة",
    selectLanguage: "اختر اللغة",
    amenities: "المرافق",
    dining: "المطاعم",
    businessAmenities: "مرافق الأعمال",
    nearbyAttractions: "المعالم القريبة",
    location: "الموقع",
    feesCharges: "الرسوم والرسوم",
    policies: "السياسات",
    bookNow: "احجز الآن",
    viewDetails: "عرض التفاصيل",
    price: "السعر",
    perNight: "لليلة",
    rating: "التقييم",
    reviews: "المراجعات",
    freeCancellation: "إلغاء مجاني",
    breakfastIncluded: "الإفطار مشمول",
    wifi: "واي فاي مجاني",
    parking: "موقف سيارات",
    pool: "مسبح",
    gym: "صالة رياضية",
    spa: "سبا",
    findYourPerfect: "ابحث عن",
    dreamDestination: "وجهتك المثالية",
    discoverAmazingHotels: "اكتشف فنادق ومنتجعات وإقامات مذهلة بأفضل الأسعار",
    whereAreYouGoing: "إلى أين أنت ذاهب؟",
    guests: "الضيوف",
    enterDetails: "أدخل التفاصيل",
    searchDestinations: "البحث عن الوجهات",
    popularDestinations: "الوجهات الشائعة",
    searchCity: "البحث عن المدينة",
    searchCities: "البحث عن المدن...",
    whereTo: "إلى أين؟",
    popularDestinationsLabel: "الوجهات الشائعة",
    selectGuestsRooms: "اختر الضيوف والغرف",
    guestsRooms: "الضيوف والغرف",
    exploreHotels: "استكشف الفنادق",
    room: "غرفة",
    rooms: "غرف",
    search: "بحث",
    qSearch: "بحث",
    // Discovery Feed
    getInspired: "احصل على الإلهام",
    discoverYourNextAdventure: "اكتشف مغامرتك القادمة",
    exploreCuratedExperiences: "استكشف التجارب المختارة، واقرأ قصص المسافرين، وابحث عن وجهتك المثالية",
    all: "الكل",
    experiences: "التجارب",
    reviews: "المراجعات",
    adventure: "المغامرة",
    culture: "الثقافة",
    cityBreak: "رحلة المدينة",
    featured: "مميز",
    // Destinations Page
    exploreAmazingDestinations: "استكشف الوجهات المذهلة",
    discoverYourNext: "اكتشف",
    adventure: "مغامرتك القادمة",
    fromBustlingCities: "من المدن الصاخبة إلى الشواطئ الهادئة، استكشف",
    incredibleDestinations: "وجهة مذهلة في جميع أنحاء الشرق الأوسط",
    cities: "مدن",
    hotels: "فنادق",
    avgRating: "متوسط التقييم",
    handPickedDestinations: "وجهات مختارة بعناية تقدم أفضل أماكن الإقامة والتجارب",
    whyBookWithUs: "لماذا تحجز معنا",
    discoverBenefits: "اكتشف فوائد اختيار HotelRBS لرحلاتك",
    bestPrices: "أفضل الأسعار",
    comparePrices: "قارن الأسعار عبر أكثر من 2500 فندق واحصل على أفضل الصفقات المضمونة",
    verifiedReviews: "مراجعات موثقة",
    readAuthenticReviews: "اقرأ مراجعات حقيقية من مسافرين حقيقيين أقاموا هناك",
    localExpertise: "الخبرة المحلية",
    getInsiderTips: "احصل على نصائح داخلية وتوصيات لكل وجهة",
    cantFindDestination: "لا يمكنك العثور على وجهتك؟",
    requestNewDestination: "طلب وجهة جديدة",
    topAttractions: "أهم المعالم",
    trustedBy: "موثوق به من قبل أكثر من مليون مسافر حول العالم",
    // Home Page
    browseByCategory: "تصفح حسب الفئة",
    findPerfectAccommodation: "ابحث عن الإقامة المثالية لاحتياجاتك",
    luxuryHotels: "فنادق فاخرة",
    businessHotels: "فنادق الأعمال",
    familySuites: "أجنحة عائلية",
    weekendGetaways: "رحلات نهاية الأسبوع",
    starAccommodations: "إقامة 5 نجوم",
    perfectForBusinessTrips: "مثالي لرحلات العمل",
    spaciousFamilyRooms: "غرف عائلية واسعة",
    perfectForShortTrips: "مثالي للرحلات القصيرة",
    featuredHotels: "فنادق مميزة",
    handPickedAccommodations: "إقامات مختارة بعناية لإقامتك المثالية",
    viewAll: "عرض الكل",
    experienceFinestHospitality: "اختبر أفضل الضيافة",
    viewAllLuxury: "عرض جميع الفنادق الفاخرة",
    perfectForBusinessTravelers: "مثالي لرجال الأعمال",
    viewAllBusiness: "عرض جميع فنادق الأعمال",
    perfectEscapes: "هروب مثالي للرحلات القصيرة",
    viewAllGetaways: "عرض جميع الرحلات",
    familyFriendlyHotels: "فنادق صديقة للعائلة",
    greatAccommodations: "إقامة رائعة للعائلة بأكملها",
    viewAllFamily: "عرض جميع الفنادق العائلية",
    // Deals Page
    specialDeals: "عروض خاصة",
    exclusiveOffers: "عروض حصرية",
    findBestDeals: "ابحث عن أفضل الصفقات ووفر على إقامتك القادمة",
    flashDeals: "عروض فلاش",
    limitedTime: "وقت محدود",
    validUntil: "صالح حتى",
    originalPrice: "السعر الأصلي",
    salePrice: "سعر البيع",
    off: "خصم",
    bookNow: "احجز الآن",
    timeLeft: "الوقت المتبقي",
    // Search Results
    searchResults: "نتائج البحث",
    hotelsFound: "فندق موجود",
    sortBy: "ترتيب حسب",
    priceLowToHigh: "السعر: من الأقل إلى الأعلى",
    priceHighToLow: "السعر: من الأعلى إلى الأقل",
    rating: "التقييم",
    distance: "المسافة",
    filters: "المرشحات",
    clearAll: "مسح الكل",
    applyFilters: "تطبيق المرشحات",
    noHotelsFound: "لم يتم العثور على فنادق",
    tryDifferentSearch: "جرب معايير بحث مختلفة",
    loading: "جاري التحميل...",
    perNight: "لليلة",
    // Hotel Details
    selectRoom: "اختر الغرفة",
    roomDetails: "تفاصيل الغرفة",
    totalPrice: "السعر الإجمالي",
    reserveNow: "احجز الآن",
    description: "الوصف",
    facilities: "المرافق",
    nearbyAttractions: "المعالم القريبة",
    reviews: "المراجعات",
    writeReview: "اكتب مراجعة",
    // Common
    save: "حفظ",
    share: "مشاركة",
    print: "طباعة",
    close: "إغلاق",
    cancel: "إلغاء",
    confirm: "تأكيد",
    continue: "متابعة",
    back: "رجوع",
    next: "التالي",
    previous: "السابق",
    submit: "إرسال",
    edit: "تعديل",
    delete: "حذف",
    update: "تحديث",
    add: "إضافة",
    remove: "إزالة",
    yes: "نعم",
    no: "لا",
    // Footer
    secureBooking: "حجز آمن",
    sslEncrypted: "مشفر SSL",
    bestPriceGuarantee: "ضمان أفضل سعر",
    lowestPrices: "أقل الأسعار",
    support247: "دعم 24/7",
    alwaysHere: "نحن هنا دائماً",
    flexiblePayment: "دفع مرن",
    multipleOptions: "خيارات متعددة",
    footerDescription: "شريكك الموثوق للعثور على أماكن الإقامة المثالية في جميع أنحاء العالم. نربط المسافرين بإقامات استثنائية، ونوفر أفضل الأسعار وتجربة حجز سلسة.",
    verified: "موثق",
    isoCertified: "معتمد ISO",
    booking: "الحجز",
    browseDestinations: "تصفح الوجهات",
    specialOffers: "عروض خاصة",
    searchHotels: "البحث عن الفنادق",
    groupBookings: "حجوزات جماعية",
    corporateTravel: "السفر للشركات",
    giftCards: "بطاقات الهدايا",
    support: "الدعم",
    helpCenter: "مركز المساعدة",
    customerService: "خدمة العملاء",
    bookingChanges: "تغييرات الحجز",
    cancellationPolicy: "سياسة الإلغاء",
    travelInsurance: "تأمين السفر",
    faq: "الأسئلة الشائعة",
    company: "الشركة",
    aboutUs: "من نحن",
    careers: "الوظائف",
    pressMedia: "الصحافة والإعلام",
    partnerWithUs: "شراكة معنا",
    investorRelations: "علاقات المستثمرين",
    blog: "المدونة",
    allRightsReserved: "جميع الحقوق محفوظة.",
    privacyPolicy: "سياسة الخصوصية",
    termsOfService: "شروط الخدمة",
    sitemap: "خريطة الموقع",
    weAccept: "نقبل:",
    // Reserve Page
    guestDetails: "تفاصيل الضيف",
    roomNumber: "رقم الغرفة",
    title: "اللقب",
    firstName: "الاسم الأول",
    lastName: "اسم العائلة",
    type: "النوع",
    adult: "بالغ",
    child: "طفل",
    age: "العمر",
    addGuest: "إضافة ضيف",
    removeGuest: "إزالة ضيف",
    continueToBooking: "المتابعة إلى الحجز",
    backToHotel: "العودة إلى الفندق",
    // Profile Page
    myBookings: "حجوزاتي",
    searchBookings: "البحث عن الحجوزات",
    fromDate: "من تاريخ",
    toDate: "إلى تاريخ",
    search: "بحث",
    bookingReference: "رقم مرجع الحجز",
    lookupBooking: "البحث عن الحجز",
    noBookingsFound: "لم يتم العثور على حجوزات",
    bookingDetails: "تفاصيل الحجز",
    hotelName: "اسم الفندق",
    checkInDate: "تاريخ الوصول",
    checkOutDate: "تاريخ المغادرة",
    bookingStatus: "حالة الحجز",
    // Booking Page
    bookingConfirmation: "تأكيد الحجز",
    paymentDetails: "تفاصيل الدفع",
    totalAmount: "المبلغ الإجمالي",
    // Wishlist
    myWishlist: "قائمة أمنياتي",
    savedHotels: "فنادق محفوظة",
    noSavedHotels: "لا توجد فنادق محفوظة بعد",
    // Account
    myAccount: "حسابي",
    personalInformation: "المعلومات الشخصية",
    accountSettings: "إعدادات الحساب",
    // Payment
    paymentSuccessful: "تم الدفع بنجاح!",
    paymentFailed: "فشل الدفع",
    paymentDeclined: "تم رفض الدفع",
    paymentCancelled: "تم إلغاء الدفع",
    thankYouPayment: "شكراً لك على الدفع. تم تأكيد حجزك الآن!",
    bookingConfirmed: "تم تأكيد الحجز!",
    paymentPending: "لم يتم الدفع بعد وتم وضع الحجز. تم تأكيد حجزك بنجاح!",
    paymentNotSuccessful: "للأسف، لم يتم الدفع بنجاح.",
    bookingNotConfirmed: "لم يتم تأكيد حجزك. لم يتم خصم أي مبالغ من حسابك.",
    paymentCancelledMessage: "لقد ألغيت عملية الدفع.",
    checkingPaymentStatus: "جارٍ التحقق من حالة الدفع...",
    retryPayment: "إعادة محاولة الدفع",
    returnToHome: "العودة إلى الصفحة الرئيسية",
    // NotFound
    pageNotFound: "404",
    oopsPageNotFound: "عذراً! الصفحة غير موجودة",
    returnToHome: "العودة إلى الصفحة الرئيسية",
    // Reviews Section
    whatTravelersSay: "ماذا يقول المسافرون",
    readReviews: "اقرأ المراجعات من مسافرين موثقين",
    // Discovery Feed
    getInspired: "احصل على الإلهام",
    discoverYourNextAdventure: "اكتشف مغامرتك القادمة",
    exploreCuratedExperiences: "استكشف التجارب المختارة، واقرأ قصص المسافرين، وابحث عن وجهتك المثالية",
    all: "الكل",
    experiences: "التجارب",
    adventure: "المغامرة",
    culture: "الثقافة",
    cityBreak: "رحلة المدينة",
    featured: "مميز",
    // Destination Story Section
    exploreDestination: "استكشف الوجهة",
    findHotels: "العثور على الفنادق",
    bestTimeToVisit: "أفضل وقت للزيارة",
    mustSeeHighlights: "أبرز المعالم التي يجب رؤيتها",
    // Hotel Details Highlights
    keyAmenities: "المرافق الرئيسية",
    keyAmenitiesDescription: "الميزات الأساسية التي تجعل إقامتك مريحة ولا تُنسى",
    highlightedFacilities: "المرافق المميزة",
    highlightedFacilitiesDescription: "الميزات والخدمات المميزة التي تميز هذا العقار",
    uniqueOfferings: "العروض الفريدة",
    uniqueOfferingsDescription: "الميزات والتجارب الخاصة التي تميز هذا الفندق/المنتجع",
    spaDescription: "استرخِ واستمتع بخدمات السبا العالمية",
    poolDescription: "استمتع بمنطقة المسبح الرائعة مع مرافق فاخرة",
    gymDescription: "حافظ على لياقتك مع مركز اللياقة البدنية المجهز بالكامل",
    restaurantDescription: "استمتع بالمأكولات الرائعة في مطاعمنا في الموقع",
    wifiDescription: "ابق متصلاً بالإنترنت عالي السرعة في جميع أنحاء العقار",
    premiumFeatureDescription: "ميزة فاخرة متاحة لراحتك",
  },
  fr: {
    hotels: "Hôtels",
    destinations: "Destinations",
    deals: "Offres",
    search: "Rechercher",
    guestNationality: "Nationalité du client",
    checkIn: "Arrivée",
    checkOut: "Départ",
    adults: "Adultes",
    children: "Enfants",
    rooms: "Chambres",
    selectCurrency: "Sélectionner la devise",
    selectLanguage: "Sélectionner la langue",
    amenities: "Équipements",
    dining: "Restauration",
    businessAmenities: "Équipements professionnels",
    nearbyAttractions: "Attractions à proximité",
    location: "Emplacement",
    feesCharges: "Frais et charges",
    policies: "Politiques",
    bookNow: "Réserver maintenant",
    viewDetails: "Voir les détails",
    price: "Prix",
    perNight: "par nuit",
    rating: "Note",
    reviews: "Avis",
    freeCancellation: "Annulation gratuite",
    breakfastIncluded: "Petit-déjeuner inclus",
    wifi: "WiFi gratuit",
    parking: "Parking",
    pool: "Piscine",
    gym: "Salle de sport",
    spa: "Spa",
    findYourPerfect: "Trouvez Votre",
    dreamDestination: "Destination Idéale",
    discoverAmazingHotels: "Découvrez des hôtels, des resorts et des séjours incroyables aux meilleurs prix",
    whereAreYouGoing: "Où allez-vous?",
    guests: "Invités",
    enterDetails: "Entrer les détails",
    searchDestinations: "Rechercher des destinations",
    popularDestinations: "Destinations Populaires",
    searchCity: "Rechercher une ville",
    searchCities: "Rechercher des villes...",
    whereTo: "Où aller?",
    popularDestinationsLabel: "Destinations populaires",
    selectGuestsRooms: "Sélectionner Invités et Chambres",
    guestsRooms: "Invités et Chambres",
    exploreHotels: "Explorer les Hôtels",
    room: "Chambre",
    rooms: "Chambres",
    search: "Rechercher",
    qSearch: "Rechercher",
    // Discovery Feed
    getInspired: "Soyez Inspiré",
    discoverYourNextAdventure: "Découvrez Votre Prochaine Aventure",
    exploreCuratedExperiences: "Explorez des expériences sélectionnées, lisez les récits de voyageurs et trouvez votre destination parfaite",
    all: "Tout",
    experiences: "Expériences",
    reviews: "Avis",
    adventure: "Aventure",
    culture: "Culture",
    cityBreak: "Week-end en Ville",
    featured: "En Vedette",
    // Destinations Page
    exploreAmazingDestinations: "Explorez des Destinations Extraordinaires",
    discoverYourNext: "Découvrez Votre",
    adventure: "Prochaine Aventure",
    fromBustlingCities: "Des villes animées aux plages sereines, explorez",
    incredibleDestinations: "destinations incroyables à travers le Moyen-Orient",
    cities: "Villes",
    hotels: "Hôtels",
    avgRating: "Note Moyenne",
    handPickedDestinations: "Destinations sélectionnées offrant les meilleurs hébergements et expériences",
    whyBookWithUs: "Pourquoi Réserver Avec Nous",
    discoverBenefits: "Découvrez les avantages de choisir HotelRBS pour vos voyages",
    bestPrices: "Meilleurs Prix",
    comparePrices: "Comparez les prix dans plus de 2 500 hôtels et obtenez les meilleures offres garanties",
    verifiedReviews: "Avis Vérifiés",
    readAuthenticReviews: "Lisez des avis authentiques de vrais voyageurs qui y ont séjourné",
    localExpertise: "Expertise Locale",
    getInsiderTips: "Obtenez des conseils d'initiés et des recommandations pour chaque destination",
    cantFindDestination: "Vous ne trouvez pas votre destination?",
    requestNewDestination: "Demander une Nouvelle Destination",
    topAttractions: "Principales Attractions",
    trustedBy: "Fiable pour plus de 1M de voyageurs dans le monde",
    // Home Page
    browseByCategory: "Parcourir par Catégorie",
    findPerfectAccommodation: "Trouvez l'hébergement parfait pour vos besoins",
    luxuryHotels: "Hôtels de Luxe",
    businessHotels: "Hôtels d'Affaires",
    familySuites: "Suites Familiales",
    weekendGetaways: "Week-ends",
    starAccommodations: "Hébergements 5 étoiles",
    perfectForBusinessTrips: "Parfait pour les voyages d'affaires",
    spaciousFamilyRooms: "Chambres familiales spacieuses",
    perfectForShortTrips: "Parfait pour les courts séjours",
    featuredHotels: "Hôtels en Vedette",
    handPickedAccommodations: "Hébergements sélectionnés pour votre séjour parfait",
    viewAll: "Voir Tout",
    experienceFinestHospitality: "Découvrez la meilleure hospitalité",
    viewAllLuxury: "Voir Tous les Hôtels de Luxe",
    perfectForBusinessTravelers: "Parfait pour les voyageurs d'affaires",
    viewAllBusiness: "Voir Tous les Hôtels d'Affaires",
    perfectEscapes: "Évasions parfaites pour courts séjours",
    viewAllGetaways: "Voir Toutes les Évasions",
    familyFriendlyHotels: "Hôtels Familiaux",
    greatAccommodations: "Excellents hébergements pour toute la famille",
    viewAllFamily: "Voir Tous les Hôtels Familiaux",
    // Deals Page
    specialDeals: "Offres Spéciales",
    exclusiveOffers: "Offres Exclusives",
    findBestDeals: "Trouvez les meilleures offres et économisez sur votre prochain séjour",
    flashDeals: "Ventes Flash",
    limitedTime: "Temps Limité",
    validUntil: "Valable Jusqu'au",
    originalPrice: "Prix Original",
    salePrice: "Prix de Vente",
    off: "de réduction",
    bookNow: "Réserver Maintenant",
    timeLeft: "Temps Restant",
    // Search Results
    searchResults: "Résultats de Recherche",
    hotelsFound: "Hôtels Trouvés",
    sortBy: "Trier Par",
    priceLowToHigh: "Prix: Croissant",
    priceHighToLow: "Prix: Décroissant",
    rating: "Note",
    distance: "Distance",
    filters: "Filtres",
    clearAll: "Tout Effacer",
    applyFilters: "Appliquer les Filtres",
    noHotelsFound: "Aucun Hôtel Trouvé",
    tryDifferentSearch: "Essayez d'autres critères de recherche",
    loading: "Chargement...",
    perNight: "par nuit",
    // Hotel Details
    selectRoom: "Sélectionner la Chambre",
    roomDetails: "Détails de la Chambre",
    totalPrice: "Prix Total",
    reserveNow: "Réserver Maintenant",
    description: "Description",
    facilities: "Équipements",
    nearbyAttractions: "Attractions à Proximité",
    reviews: "Avis",
    writeReview: "Écrire un Avis",
    // Common
    save: "Enregistrer",
    share: "Partager",
    print: "Imprimer",
    close: "Fermer",
    cancel: "Annuler",
    confirm: "Confirmer",
    continue: "Continuer",
    back: "Retour",
    next: "Suivant",
    previous: "Précédent",
    submit: "Soumettre",
    edit: "Modifier",
    delete: "Supprimer",
    update: "Mettre à Jour",
    add: "Ajouter",
    remove: "Retirer",
    yes: "Oui",
    no: "Non",
    // Footer
    secureBooking: "Réservation Sécurisée",
    sslEncrypted: "Chiffré SSL",
    bestPriceGuarantee: "Garantie Meilleur Prix",
    lowestPrices: "Prix les Plus Bas",
    support247: "Support 24/7",
    alwaysHere: "Toujours Là",
    flexiblePayment: "Paiement Flexible",
    multipleOptions: "Options Multiples",
    footerDescription: "Votre partenaire de confiance pour trouver des hébergements parfaits dans le monde entier. Nous connectons les voyageurs à des séjours exceptionnels, offrant les meilleurs prix et une expérience de réservation fluide.",
    verified: "Vérifié",
    isoCertified: "Certifié ISO",
    booking: "Réservation",
    browseDestinations: "Parcourir les Destinations",
    specialOffers: "Offres Spéciales",
    searchHotels: "Rechercher des Hôtels",
    groupBookings: "Réservations de Groupe",
    corporateTravel: "Voyages d'Affaires",
    giftCards: "Cartes Cadeaux",
    support: "Support",
    helpCenter: "Centre d'Aide",
    customerService: "Service Client",
    bookingChanges: "Modifications de Réservation",
    cancellationPolicy: "Politique d'Annulation",
    travelInsurance: "Assurance Voyage",
    faq: "FAQ",
    company: "Entreprise",
    aboutUs: "À Propos",
    careers: "Carrières",
    pressMedia: "Presse et Médias",
    partnerWithUs: "Devenir Partenaire",
    investorRelations: "Relations Investisseurs",
    blog: "Blog",
    allRightsReserved: "Tous droits réservés.",
    privacyPolicy: "Politique de Confidentialité",
    termsOfService: "Conditions d'Utilisation",
    sitemap: "Plan du Site",
    weAccept: "Nous acceptons:",
    // Reserve Page
    guestDetails: "Détails des Invités",
    roomNumber: "Numéro de Chambre",
    title: "Titre",
    firstName: "Prénom",
    lastName: "Nom de Famille",
    type: "Type",
    adult: "Adulte",
    child: "Enfant",
    age: "Âge",
    addGuest: "Ajouter un Invité",
    removeGuest: "Retirer un Invité",
    continueToBooking: "Continuer vers la Réservation",
    backToHotel: "Retour à l'Hôtel",
    // Profile Page
    myBookings: "Mes Réservations",
    searchBookings: "Rechercher des Réservations",
    fromDate: "Date de Début",
    toDate: "Date de Fin",
    search: "Rechercher",
    bookingReference: "Référence de Réservation",
    lookupBooking: "Rechercher une Réservation",
    noBookingsFound: "Aucune réservation trouvée",
    bookingDetails: "Détails de la Réservation",
    hotelName: "Nom de l'Hôtel",
    checkInDate: "Date d'Arrivée",
    checkOutDate: "Date de Départ",
    bookingStatus: "Statut de la Réservation",
    // Booking Page
    bookingConfirmation: "Confirmation de Réservation",
    paymentDetails: "Détails du Paiement",
    totalAmount: "Montant Total",
    // Wishlist
    myWishlist: "Ma Liste de Souhaits",
    savedHotels: "Hôtels Enregistrés",
    noSavedHotels: "Aucun hôtel enregistré pour le moment",
    // Account
    myAccount: "Mon Compte",
    personalInformation: "Informations Personnelles",
    accountSettings: "Paramètres du Compte",
    // Payment
    paymentSuccessful: "Paiement Réussi!",
    paymentFailed: "Échec du Paiement",
    paymentDeclined: "Paiement Refusé",
    paymentCancelled: "Paiement Annulé",
    thankYouPayment: "Merci pour votre paiement. Votre réservation est maintenant confirmée!",
    bookingConfirmed: "Réservation Confirmée!",
    paymentPending: "Le paiement n'a pas encore été effectué et la réservation est placée. Votre réservation a été confirmée avec succès!",
    paymentNotSuccessful: "Malheureusement, votre paiement n'a pas réussi.",
    bookingNotConfirmed: "Votre réservation n'a pas été confirmée. Aucun frais n'a été facturé à votre compte.",
    paymentCancelledMessage: "Vous avez annulé le processus de paiement.",
    checkingPaymentStatus: "Vérification du Statut du Paiement...",
    retryPayment: "Réessayer le Paiement",
    returnToHome: "Retour à l'Accueil",
    // NotFound
    pageNotFound: "404",
    oopsPageNotFound: "Oups! Page introuvable",
    returnToHome: "Retour à l'Accueil",
    // Reviews Section
    whatTravelersSay: "Ce que Disent les Voyageurs",
    readReviews: "Lisez les avis de voyageurs vérifiés",
    // Discovery Feed
    getInspired: "Soyez Inspiré",
    discoverYourNextAdventure: "Découvrez Votre Prochaine Aventure",
    exploreCuratedExperiences: "Explorez des expériences sélectionnées, lisez les récits de voyageurs et trouvez votre destination parfaite",
    all: "Tout",
    experiences: "Expériences",
    adventure: "Aventure",
    culture: "Culture",
    cityBreak: "Week-end en Ville",
    featured: "En Vedette",
    // Destination Story Section
    exploreDestination: "Explorer la Destination",
    findHotels: "Trouver des Hôtels",
    bestTimeToVisit: "Meilleure Période pour Visiter",
    mustSeeHighlights: "Points Forts à Ne Pas Manquer",
    // Hotel Details Highlights
    keyAmenities: "Équipements clés",
    keyAmenitiesDescription: "Caractéristiques essentielles qui rendent votre séjour confortable et mémorable",
    highlightedFacilities: "Installations mises en avant",
    highlightedFacilitiesDescription: "Caractéristiques et services premium qui distinguent cette propriété",
    uniqueOfferings: "Offres uniques",
    uniqueOfferingsDescription: "Caractéristiques et expériences spéciales qui distinguent cet hôtel/station",
    spaDescription: "Détendez-vous et régénérez-vous avec nos services spa de classe mondiale",
    poolDescription: "Profitez de notre magnifique piscine avec des équipements premium",
    gymDescription: "Restez en forme avec notre centre de fitness entièrement équipé",
    restaurantDescription: "Savourez une cuisine exquise dans nos restaurants sur place",
    wifiDescription: "Restez connecté avec Internet haut débit dans toute la propriété",
    premiumFeatureDescription: "Fonctionnalité premium disponible pour votre confort",
  },
};

interface TranslationProviderProps {
  children: ReactNode;
}

export function TranslationProvider({ children }: TranslationProviderProps) {
  const initialLanguage = localStorage.getItem("language") || "en";
  const [language, setLanguageState] = useState<string>(initialLanguage);
  const [isTranslating, setIsTranslating] = useState(false);
  
  // Initialize with the correct language strings immediately
  const getLanguageStrings = (lang: string): Record<string, string> => {
    return COMMON_STRINGS[lang as keyof typeof COMMON_STRINGS] || COMMON_STRINGS.en;
  };
  
  const [translatedStrings, setTranslatedStrings] = useState<Record<string, string>>(
    getLanguageStrings(initialLanguage)
  );

  // Set document direction on mount and when language changes
      useEffect(() => {
        // Always keep LTR layout, even for Arabic - only change language attribute
        document.documentElement.setAttribute("dir", "ltr");
        document.documentElement.setAttribute("lang", language || "en");
      }, [language]);

  // Update translations when language changes
  useEffect(() => {
    const updateTranslations = async () => {
      // Immediately set the static translations if available
      const langStrings = COMMON_STRINGS[language as keyof typeof COMMON_STRINGS];
      if (langStrings) {
        setTranslatedStrings(langStrings);
        return;
      }

      // Only use API translation if language not in COMMON_STRINGS
      setIsTranslating(true);
      try {
        const englishStrings = Object.values(COMMON_STRINGS.en);
        const translated = await translateBatch(englishStrings, language, "en");
        
        const newTranslatedStrings: Record<string, string> = {};
        Object.keys(COMMON_STRINGS.en).forEach((key, index) => {
          newTranslatedStrings[key] = translated[index] || COMMON_STRINGS.en[key];
        });
        setTranslatedStrings(newTranslatedStrings);
      } catch (error) {
        console.error("Error updating translations:", error);
        setTranslatedStrings(COMMON_STRINGS.en);
      } finally {
        setIsTranslating(false);
      }
    };

    updateTranslations();
  }, [language]);

  const setLanguage = (lang: string) => {
    setLanguageState(lang);
    localStorage.setItem("language", lang);
    // Dispatch event for other components
    window.dispatchEvent(new CustomEvent("languageChanged", { detail: lang }));
  };

  const translate = async (text: string): Promise<string> => {
    if (language === "en" || !text.trim()) {
      return text;
    }
    return await translateText(text, language, "en");
  };

  const translateKey = (key: string): string => {
    return translatedStrings[key] || key;
  };

  const value: TranslationContextType = {
    language,
    setLanguage,
    translate,
    translateKey,
    isTranslating,
    t: translatedStrings,
  };

  return (
    <TranslationContext.Provider value={value}>
      {children}
    </TranslationContext.Provider>
  );
}

export function useTranslation() {
  const context = useContext(TranslationContext);
  if (context === undefined) {
    throw new Error("useTranslation must be used within a TranslationProvider");
  }
  return context;
}

